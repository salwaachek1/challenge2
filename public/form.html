<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Kaufland challenge</title>
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <link rel="stylesheet" href="../assets/style/css/style.css" />
  </head>
  <body style=" text-align: center;">
        <label for="formFile" class="form-label" style="margin: 0 auto;">please upload your xml file</label>
        <div class="mb-12" id="fileUploadForm">          
            <form action="<?=$_SERVER['PHP_SELF']?>" class="form-inline" method="post" enctype="multipart/form-data" style="display: inline-block;">      
              <div class="form-group mb-2"><input class="form-control" type="file" name="fileToUpload" id="upload" onclick="hideErrorMessage()" ></div>
              <div class="form-group mb-2"><button type="submit" class="btn  mb-2" name="submit">Upload file</button></div>
              
            </form>
        </div>
        <div id="records" style="margin-top: 50px;"></div>
  </body>
</html>
<script>
  function hideErrorMessage(){
    $("#error").hide();
  }
  /* AJAX Request for inserted data */
  function getData() {
    
    var offset = document.getElementById("offset").value;
    console.log(offset);
    $.ajax({
      method: "POST",
      url: "/kaufland-challenge/src/fetch.php",
      data: {
        offset: offset,
      },
      success: function (response) {
        console.log("success");
        $("#msg").hide();
        var length = response.length;
        var string =
          '<table class="table table-striped table-dark" id="tab"><thead class="thead-dark"><tr><th scope="col">ID</th><th scope="col">Name</th><th scope="col">Category Name</th><th scope="col">Price</th></tr></thead><tbody>';
        var total = 0;
        if (length == 0) {
          string +=
            '<tr><td colspan="4" class="td-result" >No Records found !</td></tr></tbody></table>';
          $("#records").html(string);
        } else {
          for (var i = 0; i < length-1; i++) {
            string +=
              "<tr>" +
              "<td>" +
              response[i].entity_id +
              "</td>" +
              "<td>" +
              response[i].name +
              "</td>" +
              "<td>" +
              response[i].category_name +
              "</td>" +
              "<td>" +
              response[i].price +
              "</td>" +
              "</tr>";
          }
          key=(response.length)-1;
          string +=
            "</tbody></table>";
          $("#offset").attr("value",response[key].offset);
          $("#show").attr("style",'font-weight:bold;padding:5px;margin:5px;border:2px solid red;color:red;font-size:20px;text-decoration:none;');
          $("#records").html(string);
        }
      },
      dataType: "json",
    });
  }
</script>